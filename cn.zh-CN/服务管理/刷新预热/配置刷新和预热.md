# 配置刷新和预热

CDN提供资源的刷新和预热功能。通过刷新功能，您可以强制CDN节点回源并获取最新文件；通过预热功能您可以在业务高峰前预热热门资源，提高资源访问效率。通过本文您可以了解刷新和预热功能的配置方法，也可以查询其操作记录及可参考的API接口。

## 功能介绍

CDN提供资源的刷新功能和预热功能如下：

-   刷新功能是指提交URL刷新或目录刷新请求后，CDN节点的缓存内容将会被强制过期，当您向CDN节点请求资源时，CDN会直接回源站获取对应的资源返回给您，并将其缓存。刷新功能会降低缓存命中率。
-   预热功能是指提交URL预热请求后，源站将会主动将对应的资源缓存到CDN节点，当您首次请求时，就能直接从CDN节点缓存中获取到最新的请求资源，无需再回源站获取。预热功能会提高缓存命中率。

## 注意事项

-   刷新任务提交后，节点上对应的缓存文件将会失效，当用户再次发起访问时，节点将会回源站拉取所需资源，并重新缓存在节点上。因此提交大量的刷新任务，会清空较多缓存，从而导致回源带宽和请求突增，源站会产生较大压力。
-   预热任务提交后，L2节点将会立刻回源加载所需资源，因此提交大批量预热任务后，会生成较多的并发下载任务，从而导致回源带宽和请求突增，源站会产生较大压力。

## 使用场景

CDN提供资源的刷新功能和预热功能的适用场景如下：

-   刷新：
    -   当您源站的旧资源更新或者升级后，为避免用户受节点缓存影响仍访问的是旧资源，可通过提交对应资源的URL/目录进行刷新，用户即可直接访问到最新的资源并缓存到CDN节点。
    -   如果您的源站存在[使用限制](/cn.zh-CN/产品简介/使用限制.md)中提及的不合规内容，当您整改网址后，由于CDN节点缓存，资源仍可被访问到，可通过URL刷新删除缓存资源。
-   预热：
    -   需要运营一个大型活动时，提前将活动页涉及到的静态资源预热至CDN节点。活动开始后，用户访问的所有静态资源均已经缓存于CDN加速节点并响应。
    -   新版本安装包或是升级包发布前，发布前将资源预热至CDN加速节点。产品正式上线后，海量用户的下载请求将直接由CDN加速节点响应，提升下载速度，大幅度降低源站压力，提升用户体验。

## 操作步骤

1.  登录[CDN控制台](https://cdn.console.aliyun.com)。

2.  在左侧导航栏，单击**刷新预热**。

3.  在**刷新缓存**页签，您可以根据所需，配置刷新或预热信息。

    ![刷新预热](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1976148951/p88300.png)

    **说明：** 如果您需要自动化刷新或预热，请参见[刷新预热自动化脚本](/cn.zh-CN/新版API参考/刷新预热类接口/刷新预热自动化脚本.md)。

    |参数|说明|
    |--|--|
    |**操作类型**|操作类型包括：     -   **刷新**

您可以在源站资源被更新后刷新URL，系统将自动清除CDN节点上的垃圾数据，当您再次访问URL时，直接回源获取最新数据并缓存到CDN节点。

    -   **预热**

您可以在业务高峰前预热热门资源，也可以预热访问频率较低的冷门资源，以提高缓存命中率。 |
    |**刷新类型**|刷新类型包括：     -   **目录**

当**操作类型**选择**刷新**时，可选择该参数。

    -   **URL**

当**操作类型**选择**刷新**或**预热**时，可选择该参数。 |
    |**URL**|配置URL时不同操作类型的注意事项如下：**说明：** 当您需要刷新或预热多条请求时，请按照一行一个URL进行输入。

    -   目录刷新（刷新CDN目录）

输入的URL需以`http://`或`https://`开始，以正斜线（/）结束。

**说明：** 同一个阿里云账号每天最多可以提交100个目录刷新，一次可全部提交，目录刷新包含子目录。如果您的阿里云账号的日带宽峰值大于200 Mbps，您可以[提交工单](https://selfservice.console.aliyun.com/ticket/createIndex)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置，每次请求最多支持提交1000条目录刷新。

    -   URL刷新

输入的URL必须带有`http://`或`https://`。

**说明：**

        -   同一个阿里云账号每天最多可以提交2000条URL刷新。如果您的阿里云账号的日带宽峰值大于200 Mbps，您可以[提交工单](https://selfservice.console.aliyun.com/ticket/createIndex)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置。
        -   每次请求最多支持提交1000条URL刷新。
        -   单个域名每分钟最多支持提交1000条URL刷新。
    -   URL预热

输入的URL必须带有`http://`或`https://`。

**说明：**

        -   同一个阿里云账号每天最多可提交500条URL预热。如果您的阿里云账号的日带宽峰值大于500 Mbps，您可以[提交工单](https://selfservice.console.aliyun.com/ticket/createIndex)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置。
        -   每次请求最多可以提交100条URL预热。
        -   单个阿里云账号的预热队列最大限制为100条URL，系统根据URL提交的先后顺序进行预热。如果预热队列中未完成的任务达到了100条URL，则需要等前面提交的预热任务完成之后才能提交新的预热任务。
        -   CDN的L2 Cache节点架设在L1 Cache节点和源站之间，帮助您缓解源站压力。 |

4.  单击**提交**。

5.  单击**操作记录**页签。

6.  在**操作记录**页签下，配置查询时间、操作类型、域名或URL，单击**查询**。

    您可以查看资源刷新或预热的详细记录，包括操作内容、操作类型、操作时间、状态和进度。


## 相关API

您可以调用API接口，实现资源的刷新和预热，详情如下表所示。

|API|描述|
|---|--|
|[PushObjectCache](/cn.zh-CN/新版API参考/刷新预热类接口/预热源站内容到缓存节点.md)|调用PushObjectCache将源站的内容主动预热到L2 Cache节点上，您首次访问可直接命中缓存，缓解源站压力。|
|[DescribeRefreshQuota](/cn.zh-CN/新版API参考/刷新预热类接口/获取刷新预热的配额信息.md)|DescribeRefreshQuota查询当天URL刷新、目录刷新、预热及封禁的最大限制数量和剩余量。|
|[DescribeRefreshTasks](/cn.zh-CN/新版API参考/刷新预热类接口/获取刷新预热任务信息.md)|调用DescribeRefreshTasks查询刷新、预热状态是否在全网生效。|
|[RefreshObjectCaches](/cn.zh-CN/新版API参考/刷新预热类接口/刷新节点上的文件内容.md)|调用RefreshObjectCaches刷新节点上的文件内容。被刷新的文件缓存将立即失效，新的请求将回源获取最新的文件，支持URL批量刷新。|

