# 刷新和预热资源

CDN提供资源的刷新和预热功能，通过刷新功能，您可以删除CDN节点上已经缓存的资源，并强制CDN节点回源站获取最新资源；通过预热功能，您可以在业务高峰前预热热门资源，提前将热门资源下载并缓存到CDN节点，提高资源的访问效率。

## 功能介绍

CDN为您提供资源的刷新和预热功能，详细介绍如下：

-   刷新

    强制删除CDN所有节点上的缓存资源，当您向CDN节点请求资源时，CDN会直接回源站获取对应的资源并返回给您，同时将资源重新缓存到CDN节点。刷新功能会降低缓存命中率。

-   预热

    源站主动将对应的资源缓存到CDN节点，当您首次请求资源时，即可直接从CDN节点获取到最新的资源，无需再回源站获取。预热功能会提高缓存命中率。


## 适用场景

下表列出了刷新和预热功能常见的适用场景。

|功能|适用场景|
|--|----|
|刷新|-   **资源更新和发布**

源站的旧资源更新或升级后，为避免用户仍访问到旧的缓存资源，可通过提交对应资源的URL或目录进行刷新，用户即可直接访问到最新的资源并缓存至CDN节点。

-   **违规资源清理**

如果您的源站存在[内容审核](/cn.zh-CN/产品简介/使用限制.md)中提及的不合规内容，当您删除源站资源后，由于CDN节点缓存，资源仍可以被访问到，可通过URL刷新删除缓存资源。 |
|预热|-   **运营活动**

运营一个大型活动时，提前将活动页涉及到的静态资源预热至CDN加速节点，活动开始后用户访问的所有静态资源均已缓存至CDN加速节点，由加速节点直接响应。

-   **安装包发布**

新版本安装包或升级包发布前，提前将资源预热至CDN加速节点，产品正式上线后，海量用户的下载请求将直接由CDN加速节点响应，提升下载速度，大幅度降低源站压力，提升用户体验。 |

## 注意事项

-   提交刷新任务并成功执行后，CDN节点上对应的缓存资源将会失效，当用户再次发起访问请求时，节点会回源站拉取所需资源，并重新缓存在节点上，因此大批量提交刷新任务会清空较多缓存，导致回源带宽和请求突增，增加源站压力。
-   提交预热任务并成功执行后，L2节点会立即回源站加载所需资源，因此大批量提交预热任务会生成较多的并发下载任务，导致回源带宽和请求突增，增加源站压力。

## 刷新资源

如果您需要自动化刷新或预热，请参见[刷新预热自动化工具](/cn.zh-CN/新版API参考/刷新预热类接口/刷新预热自动化工具.md)。

1.  登录[CDN控制台](https://cdn.console.aliyun.com)。

2.  在左侧导航栏，单击**刷新预热**。

3.  在**刷新缓存**页签，配置刷新规则。

    ![刷新预热](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6612619161/p88300.png)

    |参数|说明|
    |--|--|
    |**操作类型**|选择**刷新**。|
    |**刷新类型**|支持**URL**或**目录**刷新。|
    |**URL**|    -   URL刷新
        -   输入的URL必须带有`http://`或`https://`。
        -   刷新多个URL时，请按照一行一个URL进行输入。
        -   一个账号每日最多可以提交2000条URL刷新，每次最多可以提交1000条URL刷新，单个域名每分钟最多可以提交1000条URL刷新。

如果您账号的日带宽峰值大于200 Mbps，可参考[配额管理](/cn.zh-CN/服务管理/配额管理.md)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置。

    -   目录刷新
        -   输入的URL必须以`http://`或`https://`开头，以正斜线（/）结尾。
        -   刷新多个URL时，请按照一行一个URL进行输入。
        -   一个账号每日最多可以提交100个目录刷新，一次可全部提交，目录刷新包含子目录。如果您提升了每日配额，每次最多可以提交1000条目录刷新。

如果您账号的日带宽峰值大于200 Mbps，可参考[配额管理](/cn.zh-CN/服务管理/配额管理.md)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置。 |

4.  单击**提交**。

5.  查看刷新进度。

    提交刷新任务后，您可以在**操作记录**页签中查看资源刷新的详细记录和进度。刷新数量多会影响刷新进度，请您耐心等待。

    **说明：** 如果您在OSS控制台开启了**CDN缓存自动刷新**，则无法通过CDN控制台查看OSS上的缓存自动刷新任务。


## 预热资源

如果您需要自动化刷新或预热，请参见[刷新预热自动化工具](/cn.zh-CN/新版API参考/刷新预热类接口/刷新预热自动化工具.md)。

1.  登录[CDN控制台](https://cdn.console.aliyun.com)。

2.  在左侧导航栏，单击**刷新预热**。

3.  在**刷新缓存**页签，配置预热规则。

    ![预热](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7052619161/p267536.png)

    |参数|说明|
    |--|--|
    |**操作类型**|选择**预热**。|
    |**刷新类型**|仅支持**URL**预热。|
    |**URL**|    -   输入的URL必须带有`http://`或`https://`。
    -   预热多个URL时，请按照一行一个URL进行输入。
    -   一个账号每日最多可以提交500条URL预热，每次最多可以提交100条URL预热。

如果您账号的日带宽峰值大于500 Mbps，可参考[配额管理](/cn.zh-CN/服务管理/配额管理.md)申请提升每日配额，阿里云将根据您业务的实际需求进行评估和配置。

    -   每个账号的预热队列最大为100条URL，系统根据URL提交的先后顺序进行预热，如果预热队列中未完成的任务达到了100条，需要等前面提交的预热任务完成后才能提交新的预热任务。 |

4.  单击**提交**。

5.  查看预热进度。

    提交预热任务后，您可以在**操作记录**页签中查看资源预热的详细记录和进度。预热数量多会影响预热进度，请您耐心等待。查看详细操作记录，请参见[如何查看CDN的预热任务是否执行完成](https://help.aliyun.com/document_detail/40132.htm)。


## 相关API

您可以调用API接口，实现资源的刷新和预热，详情如下表所示。

|API|描述|
|---|--|
|[PushObjectCache](/cn.zh-CN/新版API参考/刷新预热类接口/预热源站内容到缓存节点.md)|调用PushObjectCache将源站资源主动预热到L2节点，您首次访问可直接命中缓存，缓解源站压力。|
|[RefreshObjectCaches](/cn.zh-CN/新版API参考/刷新预热类接口/刷新节点上的文件内容.md)|调用RefreshObjectCaches刷新节点上的文件内容。被刷新的文件缓存将立即失效，新的请求将回源获取最新的文件，支持URL批量刷新。|
|[DescribeRefreshTasks](/cn.zh-CN/新版API参考/刷新预热类接口/获取刷新预热任务信息.md)|调用DescribeRefreshTasks查询刷新、预热状态是否在全网生效。|
|[DescribeRefreshTaskById](/cn.zh-CN/新版API参考/刷新预热类接口/通过任务编号查询刷新预热任务信息.md)|调用DescribeRefreshTaskById查询刷新状态和预热状态是否在全网生效。|
|[DescribeRefreshQuota](/cn.zh-CN/新版API参考/刷新预热类接口/获取刷新预热的配额信息.md)|调用DescribeRefreshQuota查询当天URL刷新、目录刷新、预热及封禁的每日配额数量和当日剩余量。|

